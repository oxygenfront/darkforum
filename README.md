# Документация API

## Введение
Документация API для сайта Darkforum.store

## Эндпоинты
### 1.  Получение пользователя по ID
- **Метод:** 
	- **GET /api/user/{id}**

- **Описание:** Получение информации о пользователе по его уникальному идентификатору (ID). Этот эндпоинт позволяет клиентам узнать детали о пользователе, такие как имя, роль и количество сообщений, которые он отправил.
- **Параметры запроса:** 
	-  **id** (string, обязательный): Уникальный идентификатор пользователя, информация о котором запрашивается.
- **Ответ:**
	 - **Статус код:** 200
	  - **Тело ответа:**
		  - ```
			{
				"id": "string",
				"name": "string",
				"role": "string",  // ['user', 'admin', 'warrantor']
				"count_messages": "number"
			}
			```
- **Пример запроса**
	-  **GET /api/user/12345 HTTP/1.1**
- **Пример ответа**
	-   ```
		{
			"id": "12345",
			"name": "John Doe",
			"role": "admin",
			"count_messages": 42
		}
		```
### 2. Получение статистики по сайту
- **Метод:** 
	- **GET /api/stats**
- **Описание:** Получение общей статистики форума, включая количество тем, сообщений и пользователей. Этот эндпоинт предоставляет сводную информацию о текущих данных на форуме.
- **Ответ**
	- **Статус код:** 200 (OK)
	- **Тело ответа:**
		-   ``` 
			{
				"count_themes": "number",
				"count_messages": "number",
				"count_users": "number"
			}
			```
- **Пример запроса**
	- **GET /api/stats HTTP/1.1**
- **Пример ответа**
	-   ```
		{
			"count_themes": 125,
			"count_messages": 1023,
			"count_users": 450
		} 
		```
### 3. Получение разделов на форуме
- **Метод:** 
	- **GET /api/chapters**

- **Описание:** Получение всех тем форума. Этот эндпоинт позволяет клиентам получить список доступных тем, включая информацию о количестве сообщений и авторе каждой темы.
- **Параметры запроса:**
  - **limit** (integer, обязательный): Максимальное количество тем, которые необходимо вернуть.
- **Ответ:**
  - **Статус код:** 200
  - **Тело ответа:**
	  - ```
		{
	        "data": [
	            {
	                id: string,
	                title: string,
	                count_themes: number,
	                count_messages: number
	                latest_message: {
		                id: string,
		                author_id: string
		                date_create: ISO 8601
		            }
	            }
		    ]
	    }
		```
- **Пример запроса**
	-  **GET /api/chapters?limit=10 HTTP/1.1**
- **Пример ответа**
	-   ```
		{
			"data": [
				{
					id: "14233ddb-c474-4774-a849-479a76db63ec",
					title: "Гарант сервис",
					count_themes: 1,
					count_messages: 1
					latest_message: {
						id: "4ead2e44-060d-4d7c-a814-dfc2436ee928",
						author_id: "31674caf-6b55-4bf9-9ff2-0825b1f8ab30",
						date_create: "2010-04-11T10:04:13Z"
					}
				}
			]
		}
		```
- **Примечания**
	- Параметр limit должен быть положительным целым числом.
	- Если параметр limit не указан, может применяться значение по умолчанию, определенное на стороне сервера.
### 4. Получение раздела на форуме по id
- **Метод:**
	- **GET /api/chapter/{id}**

- **Описание:** Получение информации о разделе форума по его уникальному идентификатору (ID). Этот эндпоинт позволяет получить список тем в разделе, а также информацию о самом разделе.
- **Параметры запроса:**
	- **id** (string, обязательный): Уникальный идентификатор темы, информацию о которой необходимо получить.
- **Ответ:**
  - **Статус код:** 200
  - **Тело ответа:**
	  - ``` 
		{
			id: string,
			title_chapter: string,
			themes: [
				{
					id: string,
					title_themes: string,
					author_id: string,
					date_create: ISO 8601,
					count_views: number,
					count_messages: number
				}
			]
			
		}
		```
- **Пример запроса**
	- **GET /api/chapter/1 HTTP/1.1**
- **Пример ответа**
	-  ``` 
		{
			id: "6aed2964-3e5e-46c8-92c4-e2e519280426",
			title_chapter: "Гарант сервис",
			themes: [
				{
					id: "14233ddb-c474-4774-a849-479a76db63ec",
					title_themes: "Гарант-Сервис",
					author_id: "31674caf-6b55-4bf9-9ff2-0825b1f8ab30",
					date_create: "2010-04-11T10:04:13Z",
					count_views: 12,
					count_messages: 1
				}
			]	
		}
		```
### 6. Получение темы по id
- **Метод:**
	- **GET /api/theme/{id}**

- **Описание:** Получение информации о теме форума по его уникальному идентификатору (ID). Этот эндпоинт позволяет получить тему , а также информацию о самой теме.
- **Параметры запроса:**
	- **id** (string, обязательный): Уникальный идентификатор темы, информацию о которой необходимо получить.
- **Ответ:**
  - **Статус код:** 200
  - **Тело ответа:**
	  - ``` 
		{
			id: string,
			title_theme: string,
			author_id: string,
			date_create: ISO 8601,
			isOpened: boolean,
			count_views: number,
			count_messages: number
			messages: [
				{
					id: string,
					author_id: string,
					count_likes: number,
					count_dislikes: number,
					date_create: ISO 8601,
					message: string
				}
			]
			
		}
		```
- **Пример запроса**
	- **GET /api/theme/1 HTTP/1.1**
- **Пример ответа**
	-  ``` 
		{
			id: "05923a7d-8ff0-41fa-8581-a6de472a1984",
			title_theme: "Гарант-Сервис",
			author_id: "31674caf-6b55-4bf9-9ff2-0825b1f8ab30",
			date_create: "2010-04-11T10:04:13Z",
			isOpened: false,
			count_views: 122,
			count_messages: 1
			messages: [
				{
					id: "4ead2e44-060d-4d7c-a814-dfc2436ee928",
					author_id: "31674caf-6b55-4bf9-9ff2-0825b1f8ab30",
					count_likes: 123,
					count_dislikes: 0,
					date_create: "2010-04-11T10:04:13Z",
					message: "Какой то текст о работе гаранта на сайте"
				}
			]
			
		}
		```
# Документация WebSocket API для Чата

## Введение
Документация описывает WebSocket API для чата, который позволяет взаимодействовать между пользователями, администраторами и внешними сервисами в реальном времени.

## Подключение к WebSocket

**URL:** ws://darkforum.store/chat

## События и сообщения

### 1. Отправка сообщения

- Тип сообщения: 
	- **send_message**
- Параметры:
	 - **from**: 
		 - ID пользователя отправителя.
	 - **to**: 
		 - ID пользователя получателя.
	 - **content:** 
		 - Текст сообщения.
 
- Пример сообщения:
	-   ```
		{
		     "type": "send_message",
		     "data": {
		        "from": "user123",
		        "to": "user456",
		        "content": "Привет! Как дела?"
		    }
		} 
		```
### 2. Получение сообщения

- **Тип сообщения:**
	- **message_received**
- Параметры:
	 - **from:** 
		 - ID пользователя отправителя.
	 - **content:**
		 - Текст сообщения.

- Пример сообщения:
	-   ```
		{
		    "type": "message_received",
		    "data": {
		        "from": "user123",
		        "content": "Привет! Как дела?"
		    }
		}
		```
### 3. Участие пользователя в чате

- **Тип сообщения**: 
	- **join_chat**
- Параметры:
	 - **user_id:** 
		 - ID пользователя, который присоединяется.

- Пример сообщения:
	-   ```
		{
		    "type": "join_chat",
		    "data": {
		        "user_id": "user123"
		    }
		}
		```
### 4. Уведомление о новом пользователе

- **Тип сообщения:** 
	- **user_joined**
- Параметры:
	 - **user_id:** 
		 - ID нового пользователя.

- Пример сообщения:
	-   ```
		{
		    "type": "user_joined",
		    "data": {
		        "user_id": "user123"
		    }
		}
		```
